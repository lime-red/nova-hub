<!-- templates/admin/client_secret_regenerated.html -->
{% extends "base.html" %}
{% block title %}Secret Regenerated - Nova Hub{% endblock %}

{% block breadcrumb %}
<nav class="breadcrumb">
    <ol>
        <li><a href="/dashboard">Dashboard</a></li>
        <li><a href="/admin">Admin</a></li>
        <li><a href="/admin/clients">Clients</a></li>
        <li>Secret Regenerated</li>
    </ol>
</nav>
{% endblock %}

{% block content %}
<h1>✓ Client Secret Regenerated</h1>

<article class="alert-box warning">
    <h2>⚠️ Important: Save the New Secret</h2>
    <p>The <strong>old secret has been invalidated</strong>. The new secret will <strong>only be shown once</strong>.</p>
    <p>The BBS operator will need to update their configuration immediately. The secret cannot be retrieved later - you can only regenerate another new one.</p>
</article>

<article>
    <h3>New Credentials for {{ client.bbs_name }}</h3>

    <table>
        <tr>
            <th>BBS Index</th>
            <td>{{ client.bbs_index }}</td>
        </tr>
        <tr>
            <th>Client ID</th>
            <td><code>{{ client.client_id }}</code></td>
        </tr>
        <tr>
            <th>New Client Secret</th>
            <td>
                <code id="client-secret" style="word-break: break-all;">{{ client.client_secret }}</code>
                <button onclick="copySecret()" style="margin-left: 1em;">Copy</button>
            </td>
        </tr>
    </table>
</article>

<article>
    <h3>Next Steps</h3>
    <ol>
        <li><strong>Copy the new client secret above now</strong> - it won't be shown again!</li>
        <li>Send it securely to the BBS operator</li>
        <li>Have them update their client configuration immediately</li>
        <li>The old secret will no longer work for authentication</li>
    </ol>

    <h4>Updated client configuration:</h4>
    <pre><code>[hub]
base_url = "https://your-hub-domain.com"
client_id = "{{ client.client_id }}"
client_secret = "{{ client.client_secret }}"  # <-- UPDATE THIS

[local]
bbs_index = "{{ client.bbs_index }}"</code></pre>
</article>

<div style="display: flex; gap: 1rem;">
    <a href="/admin/clients/{{ client.id }}/config" role="button">
        View Full Config
    </a>
    <a href="/admin/clients" role="button" class="secondary">
        Back to Clients
    </a>
</div>

<script>
function copySecret() {
    const secret = document.getElementById('client-secret').textContent;
    navigator.clipboard.writeText(secret).then(() => {
        alert('Client secret copied to clipboard!');
    });
}
</script>

{% endblock %}
